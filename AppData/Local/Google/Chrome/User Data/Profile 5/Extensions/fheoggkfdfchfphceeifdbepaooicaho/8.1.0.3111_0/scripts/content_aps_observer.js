/*!
 * 
 *     MCAFEE RESTRICTED CONFIDENTIAL
 *     Copyright (c) 2022 McAfee, LLC
 *
 *     The source code contained or described herein and all documents related
 *     to the source code ("Material") are owned by McAfee or its
 *     suppliers or licensors. Title to the Material remains with McAfee
 *     or its suppliers and licensors. The Material contains trade
 *     secrets and proprietary and confidential information of McAfee or its
 *     suppliers and licensors. The Material is protected by worldwide copyright
 *     and trade secret laws and treaty provisions. No part of the Material may
 *     be used, copied, reproduced, modified, published, uploaded, posted,
 *     transmitted, distributed, or disclosed in any way without McAfee's prior
 *     express written permission.
 *
 *     No license under any patent, copyright, trade secret or other intellectual
 *     property right is granted to or conferred upon you by disclosure or
 *     delivery of the Materials, either expressly, by implication, inducement,
 *     estoppel or otherwise. Any license under such intellectual property rights
 *     must be expressed and approved by McAfee in writing.
 *
 */(()=>{"use strict";const e="CACHE_STORE",t="CONTENT_HANDLER",s="EXECUTE_COMMAND",o="FOCUS_OR_CREATE_TAB",a="GET_BK_GLOBALS",n="GET_EXTENSION_STATUS",i="GET_TAB_DATA",c="TI_REQUEST",r="PLACEHOLDER_TEXT",l="REMOVE_TAB",m="SEND_TELEMETRY",u="SET_VIEWPORT",d="WHITELIST",g="RESET_NATIVE_SETTING",E="UPDATE_BK_NATIVE_SETTINGS",_="SHOW_SIDEBAR_MAIN",p="GET_POPUP_DATA",T="GET_SETTINGS_DATA",S="RESET_SETTINGS",h="GET_TYPOSQUATTING_DATA",w="IS_FRAME_BLOCKED",N="IS_WHITELISTED",O="ANY_BLOCKED_IFRAMES",I="ANY_BLOCKED_CRYPTOSCRIPTS",A="UNBLOCK_ALL_IFRAMES",b="VIEW_SITE_REPORT",R="SEARCH_ANNOTATION",C="UPDATE_ENGINE_STATS",y="SOCIAL_MEDIA_ANNOTATION",f="UPDATE_RAT_DETECTION_SHOWING_FLAG",D="SEARCH_SUGGEST",v="SAVE_FORM_INFO",L="GET_FORM_INFO_CACHE",P="CLEAR_FORM_INFO_CACHE",k="SAVE_MULTISTEP_LOGIN",F="GET_FD_WEIGHTS",U="GET_FD_EXCEPTIONS",M="GET_FD_CRF_PARAMS",G="CLEAR_DWS_INFO",x="GET_CACHED_DWS_INFO",j="UPDATE_DWS_WHITELIST",W="LAUNCH_IDPS_LOGIN",B="UPDATE_DWS_SHOWN",H="GET_APS_DETAILS",V="SIGN_UP_FORM_DETECTED",$="SET_FF_POLICY_COLLECTION",z="SET_FF_POLICY_LAST_SHOWN",K="PING_CONTENT_APS_OBSERVER",Y="BROADCAST_TO_FOREGROUND";class q{constructor(e){this.pingCommand=e,this.basePingListener()}basePingListener(e=null){chrome.runtime.onMessage.addListener(((t,s,o)=>{if(s.id!==chrome.runtime.id)return;const{command:a}=t;a===this.pingCommand&&(o({content:!0}),"function"==typeof e&&e())}))}}const X={GREEN:0,YELLOW:1,RED:2,UNKNOWN:3,HACKERSAFE:4,TYPOSQUATTING:5,PHISHING:6,*[Symbol.iterator](){for(const e of Object.keys(this))"GREEN"!==e&&"UNKNOWN"!==e&&(yield this[e])}},J=1,Q=2,Z=3,ee=2,te=0,se="1.0.0.13",oe=0,ae=1,ne=2,ie=3,ce=5,re=70,le=30,me=1,ue="ph",de="www.siteadvisor.com/",ge="https://webadvisorc.rest.gti.mcafee.com/1",Ee="https://mip.api.mcafeewebadvisor.com/v1/typosquatting?",_e="https://sadownload.mcafee.com/products/SA/Win/extensions/engines/update.json",pe="https://threat.api.mcafee.com/",Te=new Set(["www.mcafee.com"]),Se=chrome,he={NONE:0,LINKEDIN:1,INSTAGRAM:2,YOUTUBE:4,FACEBOOK:8,TWITTER:16,REDDIT:32},we=(Object.values(he).reduce(((e,t)=>e+t)),{NONE:"NONE",ONLY_SECURE_SEARCH:"ONLY_SECURE_SEARCH",ALL:"ALL",*[Symbol.iterator](){for(const e of Object.keys(this))yield e}}),{NONE:Ne,...Oe}=he,Ie="SET",Ae="GET",be={name:"EXTENSION_LOGGING",options:[0,1,2,3,4],type:"number"},Re={name:"USE_NATIVE_LOGGER",type:"boolean"},Ce={name:"CACHE_TAB_DATA",type:"object"},ye={name:"APS_EMAIL_LINKS",type:"array"};class fe{static getResetValues(){return{blockedIframes:[],cryptoBlockData:null,tabDomainTrusted:!1}}static getDefaultValues(){return fe.getResetValues()}reset(e){this.update(e,fe.getResetValues())}get(e){return Fe.cacheStore.get(Ce.name,{})[e]||fe.getDefaultValues()}set(e,t){const s=Fe.cacheStore.get(Ce.name,{});s[e]=t,Fe.cacheStore.set(Ce.name,s)}delete(e){delete Fe.cacheStore.get(Ce.name,{})[e]}update(e,t){const s=this.get(e);this.set(e,{...s,...t})}setTabBlockPageData(e,t){const s=this.get(e);this.set(e,{...s,blockPageData:t})}addBlockedFrame(e,t){this.get(e).blockedIframes.push(t)}getBlockedFrames(e){return this.get(e).blockedIframes}resetBlockedFrames(e){this.get(e).blockedIframes=[]}}class De{static PreprocessSecureSearchRegEx(e){return e.trim().split("\n")}static getBrowserSuffix(){const{CH:e,FF:t,EDGE:s}={CH:"_ch",FF:"_ff",IE:"_ie",EDGE:"_ed"},o={};return o[Z]=s,o[J]=t,o[Q]=e,o[ee]}}const{SYSTEM:ve,USER:Le}={SYSTEM:0,USER:1},Pe=De.getBrowserSuffix(),ke={DEV_MODE:{scope:ve,name:"dev_mode",value:!1},AFF_ID:{scope:ve,name:"*Affid",value:0},BINARY_VERSION:{scope:ve,name:"version",value:null},EXTENSION_VERSION_CH:{scope:ve,name:"ChromeExtVersion",value:"",writeOnly:!0},EXTENSION_VERSION_FF:{scope:ve,name:"*FirefoxXPIVersion",value:"",writeOnly:!0},EXTENSION_VERSION_ED:{scope:ve,name:"EdgeExtVersion",value:"",writeOnly:!0},BROWSER_TYPE:{scope:ve,name:"browsertype",value:"",writeOnly:!0},USER_AGENT:{scope:ve,name:"useragent",value:"",writeOnly:!0},SUGGESTION_URL:{scope:ve,name:"suggestion_url",value:""},SCRIPT_GENERATED_DEFAULT_SS_URL:{scope:Le,name:`SCRIPT_GENERATED_DEFAULT_SS_URL${Pe}`,value:""},SECURE_SEARCH_REGEXES:{scope:Le,name:"SECURE_SEARCH_REGEXES",value:"",preprocess:De.PreprocessSecureSearchRegEx},SHOW_SEARCH_SETTINGS:{scope:ve,name:"*ShowSearchSettings",value:!0},SECURE_SEARCH_TOAST_STAMP:{scope:Le,name:`*SSDateStampShowedToast${Pe}`,value:0},SECURE_SEARCH_ANNOTATION_ONLY:{scope:ve,name:"*OnlyShowAnnotationsOnSecureSearch",value:!0},SECURE_SEARCH_SHOW_ICONS:{scope:Le,name:"*Icons",value:!0},SECURE_SEARCH_CHOICE:{scope:Le,name:`*SSToastChoice${Pe}`,value:!1},SS_DEF:{scope:ve,name:`*SS_DEF${Pe}`,value:0},ANNOTATIONS_CHOICE_EXPLICIT:{scope:ve,name:`*AnnotationsChoiceExplicit${Pe}`,value:!1},CURRENT_SAO_IN_EXTENSION:{scope:Le,name:`*CurrentSAOInExtension${Pe}`,value:""},FF_EXTENSION_LAST_TOAST_TIME:{scope:Le,name:"ff_extension_last_toast_time",value:0,writeOnly:!0},FF_EXTENSION_TOAST_COUNT:{scope:Le,name:"ff_extension_toast_count",value:0,writeOnly:!0},CHECKLIST_START_INGORE_DATE_AV:{scope:ve,name:"startIgnoreDateAV",value:"",writeOnly:!0},CHECKLIST_START_IGNORE_DATE_FW:{scope:ve,name:"startIgnoreDateFW",value:"",writeOnly:!0},CHECKLIST_IGNORE_DURACTION:{scope:ve,name:"ignoreDuration",value:"14",writeOnly:!0},CHECKLIST_GRACE_PERIOD_AV:{scope:ve,name:"fixGracePeriodStartDateAV",value:"",writeOnly:!0},CHECKLIST_GRACE_PERIOD_FW:{scope:ve,name:"fixGracePeriodStartDateFW",value:"",writeOnly:!0},CHECKLIST_GRACE_PERIOD_DURATION:{scope:ve,name:"fixGracePeriodDuration",value:"24",writeOnly:!0},CRYPTOJACKING_DISABLED:{scope:ve,name:"CryptojackingDisabled",value:!1},SMA_USER_TOGGLE:{scope:ve,name:`sma_user_toggle${Pe}`,value:!1,writeOnly:!0},SMA_ANNOTATION_OPTIONS:{scope:ve,name:`sma_annotation_options${Pe}`,value:0,writeOnly:!0},PAGES_SCANNED:{scope:ve,name:"*CounterPagesScanned",value:0},PAGES_BLOCKED:{scope:ve,name:"*CounterPagesBlocked",value:0},DOWNLOADS_SCANNED:{scope:ve,name:"*CounterDownloadsScanned",value:0},DOWNLOADS_BLOCKED:{scope:ve,name:"*CounterDownloadsBlocked",value:0},CRYPTO_BLOCKED:{scope:ve,name:"*CounterCryptoJackingBlocked",value:0},BLOCKPAGE_WHITELIST:{scope:Le,name:"*WhiteList",value:""},TS_WHITELIST:{scope:Le,name:"*TListWhiteList",value:""},CSP_ID_SETTING:{scope:ve,name:"CSPIdValue",value:"__not_available__"},UNINSTALL_SURVEY_ENABLED:{scope:ve,name:"uninstall_survey_enabled",value:!1},UNINSTALL_SURVEY_URL:{scope:ve,name:"uninstall_survey_url",value:""},RAT_DETECTION_ENABLED:{scope:ve,name:"rat_detection_enabled",value:!0},IDPS_FEATURE_ENABLED:{scope:ve,name:"idps_feature_enabled",value:0},APS_COHORT:{scope:ve,name:"aps_cohort",value:0},APS_TOGGLE_SETTING:{scope:ve,name:"aps_toggle_setting",value:!0},ALT_TRIGGER:{scope:ve,name:"alt_triggers_cohort",value:0},IFRAME_FORM_CHECK_ENABLED:{scope:ve,name:"iframe_form_check_enabled",value:!0},ANNOTATION_JOURNEY_COHORT:{scope:ve,name:`annotation_journey_cohort${Pe}`,value:0},ANNOTATION_JOURNEY_TOAST:{scope:Le,name:`aj_toast${Pe}`,value:null},HTI_THROTTLE:{scope:ve,name:"hti_throttle",value:0},MTI_CLIENT_ID:{scope:ve,name:"gti_client_id",value:""}},Fe={isTrustCheckRequired:!0,ExtensionTelemetryUrl:null,scheduleManager:null,schedules:null,isNativeConnected:!0,telemetryEngine:null,postInstallationPage:"https://www.mcafee.com/consumer/v/wa-how.html",listenerManager:null,firefoxInternalUUID:"",shadowMode:"closed",browserType:ee,cacheStore:null,ffViewports:null,garbageCollector:null,typoCache:null,logger:null,loglevel:null,messageDispatcher:null,port:null,tabData:new fe,tabIdToLastClickTime:new Map,useNativeLogger:!1,wasm:null,userAgentInBase64:null,typoSquattingServer:Ee,tldParser:null,cryptoBlacklist:["wss://*.gasolina.ml/*","*://kissdoujin.com/Content/js/c-hive.js*","wss://*.sen-to-zdrowie.ml/*","*://cookiescript.info/libs/*","*://rocks.io/assets/*","*://coin-have.com/c/*","*://coinnebula.com/lib/*","wss://*.coin-have.com/","ws://digger.cryptobara.com/*","ws://*.webminepool.tk/*","*://*.lewd.ninja/static/m.js*","*://tokyodrift.ga/dropyoulike/a-o/*","*://*.2giga.link/hive/lib/*","*://papoto.com/lib/*","*://load.jsecoin.com/*","ws://*.1q2w3.fun/*","*://*/*plugins/ajcryptominer/assets/*","*://monerominer.rocks/miner.php*","*://minemytraffic.com/*","*://*.monerise.com/core/*","*://*.cookiescript.info/libs/*","ws://hive.tubetitties.com/*","wss://*.freecontent.racing/*","wss://*.hodling.faith/*","ws://gtg02.bestsecurepractice.com/proxy","*://cryptoloot.pro/lib/*","*://lmodr.biz/*","*://*.webminepool.com/lib/base.js","ws://*.sen-to-zdrowie.ml/*","ws://*.morningdigit.com/*","*://mine.nahnoji.cz/*","*://*.minescripts.info/*","*://jsecoin.com/server*","*://coinhive.com/lib*","wss://*.webminepool.tk/*","ws://*.monerise.com/proxy/*","*://kisshentai.net/Content/js/c-hive.js*","*://mataharirama.xyz/*","*://*.coinpirate.cf/*","ws://*.playerassets.info/*","wss://*.1q2w3.fun/*","*://*.1q2w3.fun/*","*://anime.reactor.cc/js/ch/cryptonight.wasm*","*://webmine.cz/miner*","wss://ws.l33tsite.info/*","*://coinhive.com/captcha*","wss://www.mutuza.win/proxy","*://*.morningdigit.com/*","ws://*.host.d-ns.ga/*","*://*.doubleclick5.xyz/*","*://miner.pr0gramm.com/xmr.min.js*","*://*.freecontent.bid/*","ws://lewd.ninja/comics/*","wss://*.monerise.com:9333/proxy/*","*://*.webminepool.com/lib/captcha.js","*://coinerra.com/lib/*","*://*.playerassets.info/*","wss://*.webmine.pro/*","wss://lewd.ninja/comics/*","*://*.doubleclick1.xyz/*","ws://*.freecontent.racing/*","*://*.googleanalytcs.com/*","wss://*.coinnebula.com/proxy*","ws://*.monerise.com:9333/proxy/*","ws://*.freecontent.loan/*","*://party-nngvitbizn.now.sh/*","wss://api.l33tsite.info/*","*://coinlab.biz/lib/coinlab.js*","wss://*.monerise.com/proxy/*","ws://www.mutuza.win/proxy","*://jscdndel.com/content/vidm.min.js*","*://listat.biz/*","*://minecrunch.co/web/*","ws://*.chainblock.science/*","*://baiduccdn1.com/lib/*","*://*.mutuza.win/worker.js","*://*.load.jsecoin.com/*","*://ppoi.org/lib/*","wss://*.chainblock.science/*","wss://*.crypto-loot.com/proxy*","wss://gtg02.bestsecurepractice.com/proxy","wss://*.coinhive.com/proxy*","*://coin-hive.com/captcha*","*://jsccnn.com/content/vidm.min.js*","*://monerominer.rocks/scripts/miner.js*","*://*.jsecoin.com/server*","*://server.jsecoin.com/*","wss://*.coin-hive.com/proxy*","*://*.doubleclick4.xyz/*","*://miner.cryptobara.com/client/*","*://*.rocks.io/assets/*","*://*.ppoi.org/lib/*","*://you.tubetitties.com/worker.js*","wss://*.googleanalytcs.com/*","wss://hive.tubetitties.com/*","*://static.reasedoper.pw/*","*://*.ppoi.org/token/*","ws://*.webmine.pro/*","*://you.tubetitties.com/hash.wasm*","*://*.doubleclick3.xyz/*","*://*.turnsocial.com/m.js","ws://*.hodling.faith/*","wss://*.morningdigit.com/*","*://*.ad-miner.com/lib/*","wss://*.2giga.link/wproxy*","ws://*.googleanalytcs.com/*","*://*.doubleclick6.xyz/*","ws://turnsocial.now.sh/*","*://cdn.cloudcoins.co/javascript/cloudcoins.min.js*","*://joyreactor.cc/ws/ch/*","*://minero.pw/miner.min.js*","*://*.webmine.pro/*","*://punchsub.net/chm.js","wss://mine.nahnoji.cz/*","wss://mine.torrent.pw/*","*://*.mutuza.win/lib/*","*://*.kickass.cd/power2/m.js","ws://*.cpu2cash.link/*","*://*.server.jsecoin.com/*","*://*.mutuza.win/processor.js","wss://turnsocial.now.sh/*","*://kiwifarms.net/js/Jawsh/xmr/xmr.min.js*","*://*.rocks.io/proxy*","*://crypto-loot.com/lib*","*://*.chmproxy.bid/lib/*","ws://*.gasolina.ml/*","*://*.stackpathdns.com/assets/javascript/cr.js","*://*.coinblind.com/lib/*","*://miner.pr0gramm.com/pm.min.js*","*://*.bewhoyouare.gq/*","wss://*.zlx.com.br/proxy*","*://a-o.ninja/apk-AO/kingofthenorth/*","*://ad-miner.com/lib/*","*://*.webminepool.com/api/*","*://*.cpu2cash.link/*","*://*.hemnes.win/*","wss://*.cpu2cash.link/*","ws://*.coinpirate.cf/*","ws://ws.l33tsite.info/*","*://digger.cryptobara.com/client/*","*://kickass.cd/m.js*","ws://*.zlx.com.br/proxy*","*://*.doubleclick2.xyz/*","*://*.amazonaws.com/doubleclick13/*","wss://*.freecontent.loan/*","*://*.host.d-ns.ga/*","*://*.candid.zone/youtube.com/*","ws://api.l33tsite.info/*","*://gtg2.bestsecurepractice.com/lib/*","wss://*.host.d-ns.ga/*","*://coin-hive.com/lib*","ws://mine.nahnoji.cz/*","wss://*.playerassets.info/*","*://*.afminer.com/code/*","wss://*.coinpirate.cf/*","*://cookiescriptcdn.pro/libs/*","*://*.goredirect.party/assets/*","*://*.ZLX.COM.BR/assets/min.js*","*://*.ZLX.COM.BR/assets/playermon.js*","*://p.hemnes.win/lib/*","*://gtg02.bestsecurepractice.com/proxy2/*","*://gtg02.bestsecurepractice.com/meri.js","*://gtg02.bestsecurepractice.com/lv.js","*://gtg02.bestsecurepractice.com/worker.js","*://gtg02.bestsecurepractice.com/processor.js","*://gtg02.bestsecurepractice.com/demo.html","*://*.turnsocial.com/c.wasm*","*://*.turnsocial.com/m.js*","*://cdn.minescripts.info/c/*","*://tokyodrift.ga/dropyoulike/backup/c.wasm*","*://punchsub.net/chm2.js","*://*.kickass.cd/webmr4.js","*://*.kickass.cd/m.js","wss://*.authedmine.com/proxy"],trustedDomains:Te,nativeSettings:ke,searchSuggest:null,ratBlacklist:[{domain:"www.beamyourscreen.com",urls:[]},{domain:"www.connectwise.com",urls:["www.connectwise.com/platform/unified-management/control"]},{domain:"get.gotoassist.com",urls:[]},{domain:"fastsupport.gotoassist.com",urls:[]},{domain:"www.join.me",urls:[]},{domain:"www.mikogo.com",urls:[]},{domain:"www.mikogo.de",urls:[]},{domain:"www.securelink.com",urls:[]},{domain:"join.zoho.com",urls:[]}],updatedByNative:!1,wssMessageDispatcher:null,wssNativeClient:null,WSS_INSTALLED:!1,isWPSInstalled:!1,searchEngines:null,enginesVersionUrl:_e,engineCheckInterval:864e5,ENGINES_VERSION:se,AUTO_PLAY_NOTIFICATION_ENABLED:!1,ALLOW_LOCALHOST:!1,IDPS_AUTH_URL:"https://csptoken.ccs.mcafee.com/auth/token",IDPS_BREACH_COUNT_URL:"https://identity.unifiedapis.mcafee.com/breach/v1/BreachCount",IDPS_CSP_CLIENT_ID:null,IDPS_IS_ENTITLED:!1,IDPS_PROVISION_ID:null,IDPS_LOGIN_DOMAIN:"https://protection.mcafee.com",UA_CLIENT:null,TYPOSQUATTING_MAX_CACHE:100,TYPOSQUATTING_EXPIRY:2592e6,WA_IMAGE_SECRET:null,apsUrlList:{shopping:{"www.amazon.com":{paths:["buy/payselect/handlers","buy/addressselect/handlers"]}},email:{"mail.google.com/mail":{selector:"table[role=presentation] > tr div[data-message-id] a"},"outlook.live.com/mail":{selector:"div[role=complementary][aria-label] a"},"outlook.office.com/mail":{selector:"div[role=complementary][aria-label] a"},"outlook.office365.com/mail":{selector:"div[role=complementary][aria-label] a"},"mail.yahoo.com":{selector:"div[role=main] ul li a"}}},apsAnimationTimeout:5e3,downloadUrls:new Set,wpsRequestedSettings:new Set(["SMA_USER_TOGGLE","SEARCH_ANNOTATION_OPTION","SMA_ANNOTATION_OPTIONS"]),permittedContentTypes:["application/vnd.microsoft.portable-executable","application/octet-stream","application/x-msdos-program","application/x-msdownload","binary/octet-stream","application/x-msdownload"],SUPPORTED_WEBSITE_LIST:["protection.mcafee.com","protection-dev-roadhouse-int.dvqa.mcafee.com","protection-dev2-roadhouse-int.dvqa.mcafee.com","protection-qa-roadhouse-int.dvqa.mcafee.com"],isHTI:!1,mtiRequestor:null,gtiServer:ge,htiServer:pe,cspClientId:"e87c73de-b45e-4427-b590-5124401795b6"},Ue={loglevel:null},Me={NONE:0,INFO:1,ERROR:2,WARN:3,DEBUG:4},Ge=1,xe=2,je=3,We=4,Be={BACKGROUND:"BACKGROUND",CONTENT:"CONTENT",TELEMETRY:"TELEMETRY",SMART_NATIVE_CLIENT:"SMART_NATIVE_CLIENT"},He={DEFAULT:"color: #000000; font-weight: normal; font-style:normal; background: #FFFFFF;",BACKGROUND:"color: #8D0DBA; font-weight: bold; background: #FFFFFF;",CONTENT:"color: #F54A26; font-weight: bold; background: #FFFFFF;",TELEMETRY:"color: #147831; font-weight: bold; background: #FFFFFF;",SMART_NATIVE_CLIENT:"color: #004d7c; font-weight: bold; background: #FFFFFF;"};class Ve{static processLog(e,t,s){t!==Me.NONE&&(s&&!Object.values(Be).includes(s)&&(s=void 0),chrome.storage.local.get(Re.name,(o=>{if(!0===o[Re.name]){s||(s=ze()?Be.BACKGROUND:Be.CONTENT);const o={processType:s,browserType:ee,extensionType:"wa",logType:t,message:e};Fe.messageDispatcher&&Fe.messageDispatcher.logger(o)}})),$e(e,t,s))}static setNativeLogging(e){Fe.useNativeLogger=e,chrome.storage.local.set(Re,e)}static log(e,t){Ve.processLog(e,Me.INFO,t)}static error(e,t){Ve.processLog(e,Me.ERROR,t)}static warn(e,t){Ve.processLog(e,Me.WARN,t)}static debug(e,t){Ve.processLog(e,Me.DEBUG,t)}}const $e=async(e,t,s)=>{const o=await Ke();if(o===Me.NONE)return;const a=s||(ze()?Be.BACKGROUND:Be.CONTENT),n=`%c[${a} ${(new Date).toLocaleString([],{hour:"2-digit",minute:"2-digit",hour12:!0})}]: %c${e}`,i=He.DEFAULT;let c=He[a];if(c||(c=i),o>=Me.ERROR&&t===xe&&console.error(n,i,i),o>=Me.INFO&&t===Ge&&console.log(n,c,i),o>=Me.WARN&&t===je){const e="color: #FFA500; font-family: sans-serif; font-weight: bolder; text-shadow: #000 1px 1px;";console.log(`%cWARN - ${n}`,e,c,i)}if(o>=Me.DEBUG&&t===We){const e="color: #FF33D7; font-family: sans-serif; font-weight: bolder; text-shadow: #000 1px 1px;";console.log(`%cDEBUG - ${n}`,e,c,i)}},ze=()=>null!==Fe.cacheStore,Ke=async()=>{const e=ze()?Fe:Ue;let t=e.loglevel;return null===e.loglevel&&(t=await Ye(),e.loglevel=null==t?te:t),Number.isInteger(t)&&Object.values(Me).includes(t)?t:te},Ye=async()=>{const e=new Promise((e=>chrome.storage.local.get(be.name,e))),t=(await e)[be.name];return Number.isInteger(t)&&Object.values(Me).includes(t)?t:null},qe={ANNOTATION:{},BackgroundIPC:null,BackgroundCommons:null,ContextTelemetry:null,TelemetryEventNames:null,UrlParser:null,Utils:null,Commands:{},CommonConstants:{},extension:null,SearchEngineHelper:null,prevLink:null,Logger:null};class Xe{static getResString(e,t){qe.ANNOTATION.resourceRequestor.getResStr(e,(s=>{s?t(s):qe.Logger.error(`Resource string ${e} failed to fetch through resource requestor`)}))}}class Je{static async toGTICategoriesString(e,t=!1){const s=e=>new Promise((t=>{Xe.getResString(e,(e=>t(e)))})),o=async(e,t)=>{const o={},a=await s(`category_id_${e}_name`);if(o.name=a,t){const t=await s(`category_id_${e}_description`);o.description=t}return o},a=[];for(const s of e)a.push(o(s,t));return await Promise.all(a)}static browserTypeToString(e=!1){let t="";switch(ee){case 1:t="FF";break;case 2:t="CH";break;case 3:t="ED";break;default:t="UN"}return e?t.toLowerCase():t}static toImagePaths(e){let t="images/browser_action/";switch(e.startsWith("small_")?e:`small_${e}`){case"small_button_green.gif":t+="green";break;case"small_button_yellow.gif":t+="yellow";break;case"small_button_red.gif":t+="red";break;case"small_button_grey.gif":t+="white";break;case"small_button_disabled.gif":t+="disabled";break;default:t+=e}return{size16:`${t}_16.png`,size20:`${t}_20.png`,size32:`${t}_32.png`,size40:`${t}_40.png`}}static colorToImagePaths(e){let t="white";switch(e){case oe:t="green";break;case ae:t="yellow";break;case ne:t="red";break;case ie:t="white";break;case ce:t="disabled"}return Je.toImagePaths(t)}static toAnnotationImageClass(e){let t="";switch(Je.toColor(e)){case oe:t="OK";break;case ne:t="WARN";break;case ae:t="INFO";break;case ie:t="UNKNOWN"}return t}static isPhishingURI(e){return e&&e.includes(ue)}static toBlockState(e){const t=Je.toColor(e);return t!==ne&&t!==ae||!Je.isPhishingURI(e.category)?isNaN(t)?X.UNKNOWN:t:X.PHISHING}static toColor(e){let t=ie;return void 0===e||void 0===e.trust||(t=e.trust>=re?oe:e.trust>le?ae:e.trust>=me?ne:ie),t}static toSiteReportUrl(e){return`${Se.runtime.getURL("html/site_status_site_report.html")}?url=${escape(e)}`}static isExtensionUrl(e){if(Q===ee&&e.startsWith(`chrome-extension://${Se.runtime.id}`)||Z===ee&&e.startsWith(`ms-browser-extension://${Se.runtime.id}`))return!0;if(J===ee){let t=Se.i18n.getMessage("@@extension_id");if(!t){const e=Se.runtime.getURL("images/web_advisor/logo.png").split("/");t=e.length>=3?e[2]:""}return t&&e.startsWith(`moz-extension://${t}`)}return!1}static isSafeUrl(e){return Je.isSiteAdvisorUrl(e)||Je.isExtensionUrl(e)}static isSiteAdvisorUrl(e){return e.startsWith(`http://${de}`)||e.startsWith(`https://${de}`)}static isPropertRedirectUrl(e){return Je.isPropertyWebURL(e)||e.startsWith("edge://")||e.startsWith("chrome://")}static isProperWebURL(e){return!!(e.startsWith("http://")||e.startsWith("https://")||e.startsWith("ftp://"))}static getUINumber(e){if(e>=1e4)return"10k+";if(e>=1e3){let t=(e/1e3).toFixed(1);return t="0"===t.substring(2,3)?t.substring(0,1):t,`${t}k+`}return`${e}`}static hasEpochTimeElapsed(e,t){return(new Date).getTime()/1e3>e+t}static isPersonalPolicyEnabled(){return!0}static isActivityPolicyEnabled(){return!0}static blockRequest(e,t,s){Se.declarativeNetRequest.getDynamicRules((o=>{0===o.filter((e=>e.condition.urlFilter===t)).length&&Se.declarativeNetRequest.updateDynamicRules({addRules:[{id:o.length+1,condition:{domains:["<all_urls>"],urlFilter:t,resourceTypes:["main_frame"]},action:{type:"block"}}]},(()=>{Ve.log(`${s} ${t} ${e}`)}))}))}}class Qe{static getURI(e){let t=e.split("?");return t.length>1?t[0]:(t=e.split("#"),t.length>1?t[0]:e)}static getCleanURI(e){let t=e;return t.endsWith("/")&&(t=t.slice(0,-1)),t.startsWith("http://")?t=t.slice(7):t.startsWith("https://")&&(t=t.slice(8)),this.getURI(t)}static getParam(e,t){const s=e.indexOf("?");if(-1===s)return null;const o=e.substring(s+1).split("&");for(let e=0;e<o.length;++e){const s=o[e].indexOf("=");if(-1===s)continue;if(o[e].substring(0,s)===t){return o[e].substring(s+1)}}return null}static getDomain(e){if(void 0===e||!/^https?:\/\//.test(e))return"";return new URL(e).hostname}static decodeQueryParam(e){return decodeURIComponent(e.replace(/\+/g," "))}}class Ze{static handlePromiseMessage(e,t=null){return new Promise(((s,o)=>{chrome.runtime.sendMessage(e,(e=>{"function"==typeof t?t(s,o,e):((e,t,s)=>{chrome.runtime.lastError&&t(chrome.runtime.lastError.message),e(s)})(s,o,e)}))}))}}class et{static cacheStore(t,s){const o=e;return Ze.handlePromiseMessage({command:o,action:t,data:s})}static isFrameBlocked(e){const t=w;return Ze.handlePromiseMessage({command:t,url:e})}static makeMTIRequest(e,t){const s={command:c,requestData:e,referer:t};return Ze.handlePromiseMessage(s)}static executeCommand(e,t){const o=s;Se.runtime.sendMessage({command:o,commandId:e,params:t})}static focusOrCreateTab(e){const t=o;Se.runtime.sendMessage({command:t,url:e})}static closeTab(){const e=l;Se.runtime.sendMessage({command:e})}static whitelist(e,t,s){const o=d;return Ze.handlePromiseMessage({action:e,command:o,type:t,data:s})}static getPopupData(){const e=p;return Ze.handlePromiseMessage({command:e})}static getSettingsData(){const e=T;return Ze.handlePromiseMessage({command:e})}static searchAnnotation(e,t){const s=R;return Ze.handlePromiseMessage({action:e,data:t,command:s})}static socialMediaAnnotation(e,t){const s=y;return Ze.handlePromiseMessage({action:e,data:t,command:s})}static async getBkGlobals(e=!1){return new Promise((t=>{const s=a;Ze.handlePromiseMessage({command:s,bIncludeSearchEngines:e}).then((e=>{t(JSON.parse(e))}))}))}static viewSiteReport(e=null,t=!1){const s=b;Se.runtime.sendMessage({command:s,url:e,showInNewTab:t})}static getTypoSquattingData(e){const t=h;return Ze.handlePromiseMessage({command:t,domain:e})}static getPlaceholderText(e){const t=r;return Ze.handlePromiseMessage({command:t,id:e})}static setViewPort(e,t){const s=u;Se.runtime.sendMessage({command:s,x:e,y:t})}static sendTelemetry(e){const t=m;Se.runtime.sendMessage({command:t,telemetry:e})}static anyBlockedIframes(e){const t=O;return Ze.handlePromiseMessage({command:t,frameUrls:e})}static anyBlockedCryptoScripts(){const e=I;return Ze.handlePromiseMessage({command:e})}static resetSettings(){const e=S;Se.runtime.sendMessage({command:e})}static sendEngineStat(e){Se.runtime.sendMessage({command:C,engine:e})}static contentHandler(e){const s=t;Se.runtime.sendMessage({command:s,message:e})}static getTabData(e={}){const t={command:i,...e};return Ze.handlePromiseMessage(t)}static isWhitelisted(e){const t={command:N,url:e};return Ze.handlePromiseMessage(t)}static getExtensionStatus(e){return Ze.handlePromiseMessage({command:n,extension_id:e})}static unblockAllIframes(){const e=A;Se.runtime.sendMessage({command:e})}static updateRatDetectionShowingFlag(e){const t=f;Se.runtime.sendMessage({command:t,showed:e})}static getSearchSuggest(e){const t={command:D,searchTerm:e};return Ze.handlePromiseMessage(t)}static resetNativeSetting(e){const t=g;Se.runtime.sendMessage({command:t,setting:e})}static saveFormInfo(e,t){const s=v;Se.runtime.sendMessage({command:s,username:e,hostname:t})}static saveMultiStepLogin(e,t){const s=k;Se.runtime.sendMessage({command:s,data:e,completeLogin:t})}static getFormInfoCache(){const e=L;return Ze.handlePromiseMessage({command:e})}static clearFormInfoCache(){const e=P;Se.runtime.sendMessage({command:e})}static updateDWSWhitelist(e){const t=j;Se.runtime.sendMessage({command:t,email:e})}static getCachedDWSInfo(e){const t={command:x,email:e};return Ze.handlePromiseMessage(t)}static clearCachedDWSInfo(e){const t=G;Se.runtime.sendMessage({command:t,email:e})}static updateDWSShown(e){const t=B;Se.runtime.sendMessage({command:t,email:e})}static getAPSDetails(){const e=H;return Ze.handlePromiseMessage({command:e})}static signUpFormDetected(){const e=V;Se.runtime.sendMessage({command:e})}static updateBkNativeSettings(e,t){const s=E;Se.runtime.sendMessage({command:s,name:e,value:t})}static launchIDPSLogin(){const e=W;Se.runtime.sendMessage({command:e})}static showSidebarMain(){const e=_;Se.runtime.sendMessage({command:e})}static setFFPolicyCollection({personal:e,activity:t}){const s=$;Se.runtime.sendMessage({command:s,personal:e,activity:t})}static setFFPolicyLastShown(){const e=z;Se.runtime.sendMessage({command:e})}static broadcastToForeground(e){const t=Y;Se.runtime.sendMessage({command:t,payload:e})}static getFDWeights(){const e=F;return Ze.handlePromiseMessage({command:e})}static getFDExceptions(){const e=U;return Ze.handlePromiseMessage({command:e})}static getFDCrfParams(){const e=M;return Ze.handlePromiseMessage({command:e})}}(new class extends q{constructor(){super(K)}async main(){const e=document.location.href,t=ye.name,s=(await et.cacheStore(Ae,{[t]:[]}))[t],{apsUrlList:o}=await et.getBkGlobals(),a=o.email,n=Object.keys(a).find((t=>e.includes(t)));if(n){const e=a[n].selector;this.initEmailObserver(e,s)}else this.initEmailObserver()}initEmailObserver(e,t){const s=()=>{const s=document.querySelectorAll(e);s.length&&s.forEach((e=>{const s=e.getAttribute("href");"true"!==e.getAttribute("mcafee_aps")&&s&&Je.isProperWebURL(s)&&(e.setAttribute("mcafee_aps","true"),e.addEventListener("click",(()=>{const e=Qe.getDomain(s);t.push(e),et.cacheStore(Ie,{[ye.name]:t})})))}))},o=new MutationObserver((()=>{s()}));s(),o.observe(document,{childList:!0,subtree:!0})}}).main()})();
//# sourceMappingURL=../sourceMap/scripts/content_aps_observer.js.map